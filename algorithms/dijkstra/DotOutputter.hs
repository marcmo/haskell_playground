import Dijkstra2
import Data.Graph
import Data.Array(array,(!))
import System.IO

g = buildG (1,4) [(1,2),(2,3),(1,3),(2,4),(3,4)]
g2 = array (0,100) [(0,[82,10,6,19]),(1,[]),(2,[81,13]),(3,[]),(4,[59]),(5,[85]),(6,[]),(7,[18,60]),(8,[7]),(9,[8]),(10,[70,32]),(11,[74,92]),(12,[99]),(13,[46,36]),(14,[98]),(15,[25]),(16,[2]),(17,[]),(18,[49]),(19,[37]),(20,[]),(21,[]),(22,[10]),(23,[52]),(24,[33]),(25,[]),(26,[]),(27,[47]),(28,[59,42]),(29,[66]),(30,[15]),(31,[67,35]),(32,[]),(33,[22,90,25]),(34,[47]),(35,[33]),(36,[27]),(37,[]),(38,[12,67,34]),(39,[9]),(40,[]),(41,[26]),(42,[]),(43,[36,61,81]),(44,[29]),(45,[41]),(46,[17]),(47,[30]),(48,[]),(49,[40,23]),(50,[]),(51,[]),(52,[87,59]),(53,[]),(54,[]),(55,[37]),(56,[]),(57,[]),(58,[]),(59,[]),(60,[]),(61,[58]),(62,[68,7]),(63,[82]),(64,[]),(65,[]),(66,[]),(67,[19]),(68,[]),(69,[]),(70,[2]),(71,[]),(72,[22,46,1,74,5]),(73,[92]),(74,[]),(75,[]),(76,[73,49,65]),(77,[88]),(78,[3,53]),(79,[]),(80,[63]),(81,[90]),(82,[52]),(83,[]),(84,[79]),(85,[6]),(86,[45]),(87,[68,16]),(88,[]),(89,[4]),(90,[]),(91,[16]),(92,[42]),(93,[71]),(94,[98]),(95,[]),(96,[80,76]),(97,[10]),(98,[56,25]),(99,[52,57,65]),(100,[49,60])] :: Graph


displayDot :: Graph -> String
displayDot g  = unlines reslist
     where reslist = ["digraph G {","color=blue;",concatMap showVertex (vertices g),"",unlines $ map showEdge (edges g),
               "label=\"graph \"","}"]
           showEdge (a,b) = show a ++ " -> " ++ show b ++ ";"
           showVertex x = show x ++ ";"

drawGraph g = do
  outh <- openFile ("graph.dot") WriteMode
  hPutStr outh $ displayDot g 
  hClose outh
  putStr $ show g




